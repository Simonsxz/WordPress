(()=>{var e={6942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{initPage:()=>Cn});var e={};n.r(e),n.d(e,{getAccount:()=>_,getCurrency:()=>W,getDeactivationDate:()=>j,getEmail:()=>A,getExtraQuotaUnits:()=>U,getFirstname:()=>k,getFullname:()=>C,getInvoices:()=>y,getLastname:()=>O,getLicense:()=>T,getMode:()=>M,getNextChargeDate:()=>Q,getNextChargeTotal:()=>V,getPeriod:()=>R,getPhoto:()=>F,getPlan:()=>I,getProductDisplay:()=>L,getSite:()=>E,getSites:()=>h,getSitesAllowed:()=>q,getStartDate:()=>P,getState:()=>B,getSubscriptionAddons:()=>w,getSubscriptionId:()=>S,getSubscriptionProduct:()=>D,getSubscriptionQuota:()=>x,getUrlToManagePayments:()=>$,isAgency:()=>Y,isAgencyFullViewEnabled:()=>K,isLocked:()=>G,isSubscriptionDeprecated:()=>N});var t={};n.r(t),n.d(t,{enableAgencyFullView:()=>J,lock:()=>H,receiveAccount:()=>X,receiveInvoices:()=>ee,receiveSites:()=>Z,removeSiteAfterUnlink:()=>te,unlock:()=>z});var a={};n.r(a),n.d(a,{cancelSubscription:()=>be,limitSiteQuota:()=>_e,linkSite:()=>pe,uncancelSubscription:()=>ge,unlinkSite:()=>fe,upgradeSubscription:()=>ve});var i={};n.r(i),n.d(i,{getAccount:()=>ye,getInvoices:()=>we,getSites:()=>Se,getSubscriptionQuota:()=>xe});const o=window.wp.element;window.wp.domReady;const c=window.wp.notices,l=window.wp.components,s=window.wp.i18n,u=window.nab.components;var d=[{label:(0,s._x)("How do I change my payment details?","text","nelio-ab-testing"),link:(0,s._x)("https://neliosoftware.com/testing/help/how-do-i-change-my-payment-details/","text","nelio-ab-testing")},{label:(0,s._x)("What if my monthly quota of page views gets exhausted?","text","nelio-ab-testing"),link:(0,s._x)("https://neliosoftware.com/testing/help/what-if-my-monthly-quota-gets-exhausted/","text","nelio-ab-testing")}],m=function(e){var t,n=e.isSubscribed,r=e.siteId,a=(0,o.useState)(!1),i=a[0],c=a[1];return(0,o.useEffect)((function(){var e=setTimeout((function(){return c(!1)}),1500);return function(){return clearTimeout(e)}}),[i]),o.createElement("h1",{className:"wp-heading-inline nelio-ab-testing-page-title"},o.createElement("span",null,n?(0,s._x)("Account Details","text","nelio-ab-testing"):(0,s._x)("Upgrade to Nelio A/B Testing Premium","user","nelio-ab-testing")),o.createElement("span",{className:"nelio-ab-testing-page-title__support-key"},o.createElement("strong",null,(0,s._x)("Support Key:","text","nelio-ab-testing")),o.createElement("code",null,r),!!(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)&&o.createElement(l.IconButton,{icon:"admin-page",onClick:function(){return!i&&void navigator.clipboard.writeText(r).then((function(){return c(!0)}))}})),i&&o.createElement(l.Snackbar,{className:"nelio-ab-testing-page-title__support-key-copied"},(0,s._x)("Copied!","text (support key)","nelio-ab-testing")))};const p=window.wp.data,f=window.lodash;var b="nab/account",g={account:{currency:"USD",deactivationDate:"",email:"",firstname:"",fullname:"",isAgency:!1,lastname:"",license:"",mode:"free",nextChargeDate:"",nextChargeTotal:"",period:"month",photo:"",plan:"free",productDisplay:"",productId:"",quota:500,quotaExtra:0,quotaPerMonth:0,sitesAllowed:1,startDate:"",state:"active",subscription:"",addons:[],addonDetails:{},urlToManagePayments:""},invoices:[],sites:[],isPageLocked:!1,isAgencyFullViewEnabled:!1},v=function(){return v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},v.apply(this,arguments)};function _(e){return e.account}function h(e,t){return t?e.sites:[]}function E(e,t){return(0,f.find)(e.sites,{id:t})}function y(e,t){return t?e.invoices:[]}function x(e){var t=e.account,n=t.quota,r=t.quotaExtra,a=t.quotaPerMonth,i=n+r;return{mode:"subscription",availableQuota:i,percentage:Math.floor(100*(i+.1)/a)}}function S(e){return e.account.subscription}function w(e){return e.account.addons||[]}function N(e){return!!e.account.subscription.startsWith("OL")}function C(e){return e.account.fullname}function k(e){return e.account.firstname}function O(e){return e.account.lastname}function A(e){return e.account.email}function P(e){return e.account.startDate}function D(e){return e.account.productId}function I(e){return e.account.plan}function T(e){return e.account.license}function F(e){return e.account.photo}function L(e){return e.account.productDisplay}function M(e){return e.account.mode}function R(e){return e.account.period}function U(e){var t,n;return null!==(n=null!==(t=e.account.addonDetails["nab-pageviews-monthly"])&&void 0!==t?t:e.account.addonDetails["nab-pageviews-yearly"])&&void 0!==n?n:0}function B(e){return e.account.state}function j(e){return e.account.deactivationDate}function Q(e){return e.account.nextChargeDate}function V(e){return e.account.nextChargeTotal}function q(e){return e.account.sitesAllowed}function W(e){return e.account.currency}function $(e){return e.account.urlToManagePayments}function Y(e){return!!e.account.isAgency}function G(e){return!!e.isPageLocked}function K(e){return Y(e)&&!!e.isAgencyFullViewEnabled}function H(){return{type:"LOCK_PAGE"}}function z(){return{type:"UNLOCK_PAGE"}}function J(){return{type:"ENABLE_AGENCY_FULL_VIEW"}}function X(e){return{type:"RECEIVE_ACCOUNT",account:e}}function Z(e){return{type:"RECEIVE_SITES",sites:(0,f.castArray)(e)}}function ee(e){return{type:"RECEIVE_INVOICES",invoices:(0,f.castArray)(e)}}function te(e){return{type:"UNLINK_SITE",id:e}}const ne=window.wp.apiFetch;var re=n.n(ne);const ae=window.wp.date,ie=window.wp.url;var oe=function(){return oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},oe.apply(this,arguments)};const ce=function(e){var t=e.url,n=e.path,r=(0,ae.format)("YmjHi").substring(0,11)+"0";return re()(oe(oe(oe({},e),t&&{url:le(e)?(0,ie.addQueryArgs)(t,{nabts:r}):t}),n&&{path:(0,ie.addQueryArgs)(n,{nabts:r})}))};var le=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const se=window.nab.utils;var ue=function(){return ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ue.apply(this,arguments)},de=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((r=r.apply(e,t||[])).next())}))},me=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};function pe(e){return de(this,void 0,void 0,(function(){var t;return me(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),(0,p.dispatch)(b).lock(),[4,ce({path:"/nab/v1/site/subscription",method:"POST",data:{license:e}})];case 1:return n.sent(),window.location.reload(),[3,3];case 2:return t=n.sent(),(0,p.dispatch)(b).unlock(),(0,se.createErrorNotice)(t),[3,3];case 3:return[2]}}))}))}function fe(e){return de(this,void 0,void 0,(function(){var t,n;return me(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(0,p.dispatch)(b).lock(),[4,ce({path:"/nab/v1/site/".concat(e,"/subscription"),method:"DELETE"})];case 1:return r.sent(),(null==(t=(0,p.select)(b).getSite(e))?void 0:t.isCurrentSite)?(window.location.reload(),[2]):((0,p.dispatch)(b).unlock(),(0,p.dispatch)(b).removeSiteAfterUnlink(e),[3,3]);case 2:return n=r.sent(),(0,p.dispatch)(b).unlock(),(0,se.createErrorNotice)(n),[3,3];case 3:return[2]}}))}))}function be(){return de(this,void 0,void 0,(function(){var e,t;return me(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),(0,p.dispatch)(b).lock(),e=(0,p.select)(b).getSubscriptionId(),[4,ce({path:"/nab/v1/subscription/".concat(e),method:"DELETE"})];case 1:return n.sent(),window.location.reload(),[3,3];case 2:return t=n.sent(),(0,p.dispatch)(b).unlock(),(0,se.createErrorNotice)(t),[3,3];case 3:return[2]}}))}))}function ge(){return de(this,void 0,void 0,(function(){var e,t;return me(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),(0,p.dispatch)(b).lock(),e=(0,p.select)(b).getSubscriptionId(),[4,ce({path:"/nab/v1/subscription/".concat(e,"/uncancel"),method:"POST"})];case 1:return n.sent(),window.location.reload(),[3,3];case 2:return t=n.sent(),(0,p.dispatch)(b).unlock(),(0,se.createErrorNotice)(t),[3,3];case 3:return[2]}}))}))}function ve(e,t){return de(this,void 0,void 0,(function(){var n,r;return me(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),(0,p.dispatch)(b).lock(),n=(0,p.select)(b).getSubscriptionId(),[4,ce({path:"/nab/v1/subscription/".concat(n),method:"PUT",data:{product:e,extraQuotaUnits:t}})];case 1:return a.sent(),window.location.reload(),[3,3];case 2:return r=a.sent(),(0,p.dispatch)(b).unlock(),(0,se.createErrorNotice)(r),[3,3];case 3:return[2]}}))}))}function _e(e,t){return de(this,void 0,void 0,(function(){var n,r,a,i;return me(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=(0,p.select)(b).getSubscriptionId(),r=(0,p.select)(b).getSites(n),[4,ce({path:"/nab/v1/site/".concat(e),method:"PUT",data:{maxMonthlyQuota:t}})];case 1:return a=o.sent(),(0,p.dispatch)(b).receiveSites(r.map((function(e){return e.id===a.id?ue(ue(ue({},e),a),{maxMonthlyQuota:t}):e}))),[3,3];case 2:return i=o.sent(),(0,se.createErrorNotice)(i),[3,3];case 3:return[2]}}))}))}var he=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}l((r=r.apply(e,t||[])).next())}))},Ee=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}};function ye(){return he(this,void 0,void 0,(function(){var e,t;return Ee(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,ce({path:"/nab/v1/account"})];case 1:return e=n.sent(),(0,p.dispatch)(b).receiveAccount(e),[3,3];case 2:throw t=n.sent(),(0,se.createErrorNotice)(t,(0,s._x)("Error while accessing site info.","text","nelio-ab-testing")),t;case 3:return[2]}}))}))}function xe(){return he(this,void 0,void 0,(function(){return Ee(this,(function(e){switch(e.label){case 0:return[4,(0,p.resolveSelect)(b).getAccount()];case 1:return e.sent(),[2]}}))}))}function Se(e){return he(this,void 0,void 0,(function(){var t,n;return Ee(this,(function(r){switch(r.label){case 0:if(!e)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ce({path:"/nab/v1/subscription/".concat(e,"/sites")})];case 2:return t=r.sent(),(0,p.dispatch)(b).receiveSites(t),[3,4];case 3:throw n=r.sent(),(0,se.createErrorNotice)(n,(0,s.sprintf)(/* translators: subscription id */ /* translators: subscription id */
(0,s._x)("Error while accessing sites in subscription %s.","text","nelio-ab-testing"),e)),n;case 4:return[2]}}))}))}function we(e){return he(this,void 0,void 0,(function(){var t,n;return Ee(this,(function(r){switch(r.label){case 0:if(!e)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ce({path:"/nab/v1/subscription/".concat(e,"/invoices")})];case 2:return t=r.sent(),(0,p.dispatch)(b).receiveInvoices(t),[3,4];case 3:throw n=r.sent(),(0,se.createErrorNotice)(n,(0,s.sprintf)(/* translators: subscription id */ /* translators: subscription id */
(0,s._x)("Error while accessing invoices in subscription %s.","text","nelio-ab-testing"),e)),n;case 4:return[2]}}))}))}var Ne,Ce=function(){return Ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ce.apply(this,arguments)},ke=Ce(Ce({},t),a);(0,p.registerStore)(b,{reducer:function(e,t){var n;return void 0===e&&(e=g),null!==(n=function(e,t){switch(t.type){case"RECEIVE_ACCOUNT":return v(v({},e),{account:t.account});case"RECEIVE_INVOICES":return v(v({},e),{invoices:t.invoices});case"RECEIVE_SITES":return v(v({},e),{sites:t.sites});case"UNLINK_SITE":return v(v({},e),{sites:(0,f.reject)(e.sites,{id:t.id})});case"LOCK_PAGE":return v(v({},e),{isPageLocked:!0});case"UNLOCK_PAGE":return v(v({},e),{isPageLocked:!1});case"ENABLE_AGENCY_FULL_VIEW":return v(v({},e),{isAgencyFullViewEnabled:!0})}}(e,t))&&void 0!==n?n:e},controls:p.controls,actions:ke,selectors:e,resolvers:i});var Oe=null!==(Ne=null===c.store||void 0===c.store?void 0:c.store.name)&&void 0!==Ne?Ne:"core/notices",Ae=function(e){var t=e.children,n=Pe(),r=De(),a=Ie(),i=(0,p.useDispatch)(Oe).removeNotice;return n?o.createElement(u.LoadingAnimation,{text:(0,s._x)("Loading…","text","nelio-ab-testing")}):o.createElement(o.Fragment,null,o.createElement(l.NoticeList,{notices:a,className:"components-editor-notices__pinned",onRemove:i}),!r&&t)},Pe=function(){return(0,p.useSelect)((function(e){return e(b).getAccount(),!e(b).hasFinishedResolution("getAccount")}))},De=function(){return(0,p.useSelect)((function(e){return e(b).hasResolutionFailed("getAccount")}))},Ie=function(){return(0,p.useSelect)((function(e){return e(Oe).getNotices()}))};const Te=window.React;function Fe(e){return e.startsWith("{{/")?{type:"componentClose",value:e.replace(/\W/g,"")}:e.endsWith("/}}")?{type:"componentSelfClosing",value:e.replace(/\W/g,"")}:e.startsWith("{{")?{type:"componentOpen",value:e.replace(/\W/g,"")}:{type:"string",value:e}}function Le(e,t){let n,r,a=[];for(let i=0;i<e.length;i++){const o=e[i];if("string"!==o.type){if(void 0===t[o.value])throw new Error(`Invalid interpolation, missing component node: \`${o.value}\``);if("object"!=typeof t[o.value])throw new Error(`Invalid interpolation, component node must be a ReactElement or null: \`${o.value}\``);if("componentClose"===o.type)throw new Error(`Missing opening component token: \`${o.value}\``);if("componentOpen"===o.type){n=t[o.value],r=i;break}a.push(t[o.value])}else a.push(o.value)}if(n){const i=function(e,t){const n=t[e];let r=0;for(let a=e+1;a<t.length;a++){const e=t[a];if(e.value===n.value){if("componentOpen"===e.type){r++;continue}if("componentClose"===e.type){if(0===r)return a;r--}}}throw new Error("Missing closing component token `"+n.value+"`")}(r,e),o=Le(e.slice(r+1,i),t),c=(0,Te.cloneElement)(n,{},o);if(a.push(c),i<e.length-1){const n=Le(e.slice(i+1),t);a=a.concat(n)}}return a=a.filter(Boolean),0===a.length?null:1===a.length?a[0]:(0,Te.createElement)(Te.Fragment,null,...a)}function Me(e){const{mixedString:t,components:n,throwErrors:r}=e;if(!n)return t;if("object"!=typeof n){if(r)throw new Error(`Interpolation Error: unable to process \`${t}\` because components is not an object`);return t}const a=function(e){return e.split(/(\{\{\/?\s*\w+\s*\/?\}\})/g).map(Fe)}(t);try{return Le(a,n)}catch(e){if(r)throw new Error(`Interpolation Error: unable to process \`${t}\` because of error \`${e.message}\``);return t}}const Re=window.nab.data,Ue=window.nab.date;var Be=function(e){var t=e.siteId,n=(0,p.useSelect)((function(e){return e(b).getProductDisplay()}));return o.createElement("div",{className:"nab-account-container__box nab-plan"},o.createElement("div",{className:"nab-plan__content"},o.createElement("h3",{className:"nab-plan__title"},n,o.createElement("span",{className:"nab-plan__period"},(0,s._x)("Agency Plan","text","nelio-ab-testing"))),o.createElement("div",{className:"nab-plan__renewal"},(0,s._x)("You’re currently using an agency subscription plan.","user","nelio-ab-testing")),o.createElement(u.QuotaMeter,null)),o.createElement("div",{className:"nab-plan__actions"},o.createElement(je,{siteId:t}),o.createElement(Qe,null)))},je=function(e){var t=e.siteId,n=(0,o.useState)(!1),r=n[0],a=n[1],i=(0,p.useDispatch)(b).unlinkSite,c=function(){return a(!1)};return o.createElement(o.Fragment,null,o.createElement(l.Button,{isDestructive:!0,className:"nab-plan__action",onClick:function(){return a(!0)}},(0,s._x)("Downgrade to Free Version","command","nelio-ab-testing")),o.createElement(u.ConfirmationDialog,{title:(0,s._x)("Downgrade to Free version?","text","nelio-ab-testing"),text:(0,s._x)("This will remove the subscription license from the site and you’ll be using Nelio A/B Testing’s free version.","text","nelio-ab-testing"),confirmLabel:(0,s._x)("Downgrade","command","nelio-ab-testing"),isOpen:r,onCancel:c,onConfirm:function(){c(),i(t)}}))},Qe=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1],r=(0,o.useState)(""),a=r[0],i=r[1],c=(0,o.useState)(!1),u=c[0],d=c[1],m=(0,p.useDispatch)(b),g=m.enableAgencyFullView,v=m.receiveAccount;return o.createElement("div",null,o.createElement(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!0)}},(0,s._x)("View Details","command","nelio-ab-testing")),t&&o.createElement(l.Popover,{className:"nab-license-form",noArrow:!1,position:"bottom left"},o.createElement(l.TextControl,{value:a,placeholder:(0,s._x)("Type your license here","user","nelio-ab-testing"),className:"nab-license-form__text-control",onChange:function(e){return i((0,f.trim)(e))}}),o.createElement(l.Button,{variant:"primary",isBusy:u,className:"nab-license-form__button",onClick:function(){d(!0),ce({path:"/nab/v1/account/agency",method:"POST",data:{license:a}}).then((function(e){v(e),g(),d(!1),n(!1)})).catch((function(){d(!1)}))},disabled:!a.length||u},u?(0,s._x)("Validating…","text","nelio-ab-testing"):(0,s._x)("Validate","command","nelio-ab-testing"))))},Ve=function(e){var t=e.isOpen,n=e.position,r=e.onFocusOutside,a=qe(),i=We(),c=i.addons,d=i.enabledAddons,m=(0,o.useState)(!1),f=m[0],g=m[1],v=(0,o.useState)(),_=v[0],h=v[1],E=$e(),y=(0,p.useSelect)((function(e){return e(b).isLocked()})),x=(0,p.useDispatch)(b),S=x.lock,w=x.unlock;if(f){if(!_)return null;var N=_.displayName,C=_.displayPrice;return o.createElement(u.ConfirmationDialog,{title:(0,s.sprintf)(/* translators: addon name */ /* translators: addon name */
(0,s._x)("Upgrade your subscription to include %s?","text","nelio-ab-testing"),N),text:Me({mixedString:(0,s.sprintf)(/* translators: 1 -> addon name, 2 -> addon price */ /* translators: 1 -> addon name, 2 -> addon price */
(0,s._x)("This will include the %1$s addon to your subscription for an additional charge of %2$s. You will be charged today.","text","nelio-ab-testing"),N,"{{strong}}".concat(C,"{{/strong}}")),components:{strong:o.createElement("strong",null)}}),confirmLabel:(0,s._x)("Upgrade Now","command","nelio-ab-testing"),isOpen:f,isConfirmBusy:y,onCancel:function(){return g(!1)},onConfirm:function(){S(),ce({path:"/nab/v1/activate/recordings",method:"POST"}).then((function(){return window.location.reload()})).catch((function(e){return(0,se.createErrorNotice)(e)})).finally((function(){w(),h(void 0),g(!1)}))}})}return t?a?o.createElement(l.Popover,{className:"nab-addons nab-addons--loading",noArrow:!1,position:n,onFocusOutside:r},o.createElement(l.Spinner,null)):o.createElement(l.Popover,{className:"nab-addons",noArrow:!1,position:n,onFocusOutside:r},o.createElement("div",{className:"nab-addons__container"},o.createElement("div",{className:"nab-addons__container-title"},(0,s._x)("Addons","text","nelio-ab-testing")),o.createElement("div",{className:"nab-addons__container-list"},c.map((function(e){var t=e.id,n=e.displayName,r=e.price,a=e.period;return o.createElement("div",{className:"nab-addons__product",key:t},o.createElement("div",{className:"nab-addons__product-details"},o.createElement("div",{className:"nab-addons__product-name"},Ge(n)),!d.includes(t)&&o.createElement("div",{className:"nab-addons__product-price",title:E},Ye(r[E]||0,E,a))),o.createElement("div",{className:"nab-addons__product-action"},d.includes(t)?o.createElement("span",{className:"nab-addons__product--enabled"},(0,s._x)("Enabled","text","nelio-ab-testing")):o.createElement(l.Button,{variant:"primary",disabled:y,isBusy:y,onClick:function(){h({displayName:Ge(n),displayPrice:Ye(r[E]||0,E,a)}),g(!0)}},(0,s._x)("Enable","text","nelio-ab-testing"))))}))),o.createElement(l.Button,{className:"screen-reader-text",onClick:r},(0,s._x)("Close addons","command","nelio-ab-testing")))):null},qe=function(){return(0,p.useSelect)((function(e){return!e(Re.STORE_NAME).hasFinishedResolution("getProducts")}))},We=function(){return(0,p.useSelect)((function(e){var t,n=e(Re.STORE_NAME).getProducts,r=e(b),a=r.getSubscriptionProduct,i=r.getSubscriptionAddons,o=a(),c=i(),l=n(),s=(null===(t=l.find((function(e){return e.id===o})))||void 0===t?void 0:t.allowedAddons)||[];return{addons:l.filter((function(e){return e.isAddon&&s.includes(e.id)})),enabledAddons:c}}))},$e=function(){return(0,p.useSelect)((function(e){return e(b).getCurrency()||"USD"}))},Ye=function(e,t,n){var r="month"===n?(0,s._x)(" / month","text","nelio-ab-testing"):(0,s._x)(" / year","text","nelio-ab-testing"),a="EUR"===t?"".concat(e,"€"):"US$".concat(e);return"".concat(a," ").concat(r).trim()},Ge=function(e){return(0,Ue.getLocale)().startsWith("es")?e.es:e.en},Ke=function(e){var t=e.isOpen,n=e.position,r=e.onClick,a=e.onFocusOutside,i=(0,o.useState)(""),c=i[0],u=i[1],d=(0,p.useDispatch)(b).linkSite;return t?o.createElement(l.Popover,{className:"nab-license-form",noArrow:!1,position:n,onFocusOutside:a},o.createElement(l.TextControl,{value:c,placeholder:(0,s._x)("Type your license here","user","nelio-ab-testing"),maxLength:Math.max(21,26),className:"nab-license-form__text-control",onChange:function(e){return u((0,f.trim)(e))}}),o.createElement(l.Button,{variant:"primary",className:"nab-license-form__button",disabled:21!==c.length&&26!==c.length,onClick:function(){r(),d(c)}},(0,s._x)("Apply","command","nelio-ab-testing"))):null},He=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},ze={monthly:{product:"nab-enterprise-monthly",quotaAddon:"nab-pageviews-monthly"},yearly:{product:"nab-enterprise-yearly",quotaAddon:"nab-pageviews-yearly"}},Je=[ze.monthly.product,ze.yearly.product],Xe=2e5,Ze=[0,2,4,6,11,16],et=function(e){var t=e.back,n=e.isOpen,r=e.position,a=e.onClick,i=e.onFocusOutside,c=tt(),u=nt(),d=at(),m=d.wasYearly,f=d.previousAddonQuantity,g=lt(He([f],Ze.filter((function(e){return e>f})),!0),7),v=(0,o.useState)(g[0]),_=v[0],h=v[1],E=(0,o.useState)(m),y=E[0],x=E[1],S=rt(y?"yearly":"monthly",_),w=m?"/"+(0,s._x)("year","text","nelio-ab-testing"):"",N=(0,p.useDispatch)(b).upgradeSubscription;return n?Je.some((function(e){return!u.map((function(e){return e.id})).includes(e)}))?o.createElement(l.Popover,{className:"nab-enterprise-upgrade-form nab-enterprise-upgrade-form nab-enterprise-upgrade-form--error",noArrow:!1,position:r,onFocusOutside:i},o.createElement("p",null,(0,s._x)("Something went wrong while retrieving plans. Please contact Nelio support.","user","nelio-ab-testing"))):c?o.createElement(l.Popover,{className:"nab-enterprise-upgrade-form nab-enterprise-upgrade-form--loading",noArrow:!1,position:r,onFocusOutside:i},o.createElement(l.Spinner,null)):o.createElement(l.Popover,{className:"nab-enterprise-upgrade-form",noArrow:!1,position:r,onFocusOutside:i},o.createElement("div",{className:"nab-enterprise-upgrade-form__container"},o.createElement("h3",null,(0,s.sprintf)("Enterprise%1$s",S?" (".concat(S).concat(w,")"):"")),o.createElement(l.SelectControl,{label:(0,s._x)("Monthly Page Views","text","nelio-ab-testing"),value:"".concat(_),options:g.map((function(e){return{value:"".concat(e),label:ct(Xe+5e4*e)}})),onChange:function(e){return h(Number.parseInt(e))},help:f>=0?(0,s.sprintf)(/* translators: number of page views */ /* translators: number of page views */
(0,s._x)("Currently set to %s","text","nelio-content"),ct(Xe+5e4*f)):void 0}),!m&&o.createElement(l.CheckboxControl,{checked:y,onChange:function(e){return x(e)},label:(0,s._x)("Pay yearly","command","nelio-ab-testing")})),o.createElement("div",{className:"nab-enterprise-upgrade-form__button-container"},t&&o.createElement(l.Button,{variant:"secondary",className:"nab-enterprise-upgrade-form__button",onClick:t},(0,s._x)("Back","command","nelio-ab-testing")),o.createElement(l.Button,{variant:"primary",className:"nab-enterprise-upgrade-form__button",onClick:function(){a(),N(y?ze.yearly.product:ze.monthly.product,_)}},(0,s._x)("Upgrade Subscription","command (subscription)","nelio-ab-testing")))):null},tt=function(){return(0,p.useSelect)((function(e){return!e(Re.STORE_NAME).hasFinishedResolution("getProducts")}))},nt=function(){return(0,p.useSelect)((function(e){return e(Re.STORE_NAME).getProducts()}))},rt=function(e,t){return(0,p.useSelect)((function(n){var r,a=n(Re.STORE_NAME).getProducts(),i=n(b).getCurrency()||"USD",o=a.find((function(t){return t.id===ze[e].product})),c=a.find((function(t){return t.id===ze[e].quotaAddon}));if(!o||!c)return"";var l=function(e){var t,n;return null!==(n=null!==(t=e.price[i])&&void 0!==t?t:e.price.USD)&&void 0!==n?n:0},s=(0,f.toPairs)(null!==(r=c.quantityDiscounts)&&void 0!==r?r:{}).map((function(e){var t=e[0],n=e[1];return[Number.parseInt(t),n]})).reduce((function(e,n){var r=n[0],a=n[1];return r<=t?a:e}),0)/100,u=l(o)+l(c)*t*(1-s);return ot(u,i)}))},at=function(){return(0,p.useSelect)((function(e){return{wasYearly:"year"===e(b).getPeriod(),previousAddonQuantity:"enterprise"!==e(b).getPlan()?-1:e(b).getExtraQuotaUnits()}}))},it=function(){try{return new Intl.NumberFormat((0,Ue.getLocale)().replace("_","-"))}catch(e){return new Intl.NumberFormat("en-US")}}(),ot=function(e,t){return"EUR"===t?"".concat(it.format(Math.ceil(e)),"€"):"USD".concat(it.format(Math.ceil(e)))},ct=function(e){return it.format(e)},lt=function(e,t){var n,r=e[e.length-1]||0,a=He(He([],e,!0),(0,f.range)(1,t).map((function(e){return r+20*e})),!0).slice(1,t);return He([null!==(n=a[0])&&void 0!==n?n:0],a.slice(1),!0)},st=function(){return st=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},st.apply(this,arguments)},ut=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},dt=function(e){var t=e.isOpen,n=e.position,r=e.onClick,a=e.onFocusOutside,i=e.showEnterprise,c=mt(),u=pt(),d=ft(),m=(0,p.useDispatch)(b).upgradeSubscription,f=(0,o.useState)(""),g=f[0],v=f[1];return t?c?o.createElement(l.Popover,{className:"nab-regular-upgrade-form nab-regular-upgrade-form--loading",noArrow:!1,position:n,onFocusOutside:a},o.createElement(l.Spinner,null)):o.createElement(l.Popover,{className:"nab-regular-upgrade-form",noArrow:!1,position:n,onFocusOutside:a},o.createElement("div",{className:"nab-regular-upgrade-form__product-container"},o.createElement("h3",null,(0,s._x)("Subscription Plans","text","nelio-ab-testing")),o.createElement(l.RadioControl,{selected:g,options:u.map((function(e){var t=e.id,n=e.displayName,r=e.price,a=e.description,i=e.enabledAddons;return{label:o.createElement("div",{className:"nab-regular-upgrade-form__product"},o.createElement("strong",{className:"nab-regular-upgrade-form__product-name"},vt(n)),o.createElement("span",{className:"nab-regular-upgrade-form__product-price",title:d},gt(t,(r[d]||0)+i.reduce((function(e,t){return e+(t.price[d]||0)}),0),d)),o.createElement("span",{className:"nab-regular-upgrade-form__product-description"},vt(a))),value:t}})),onChange:function(e){e&&("nab-enterprise-placeholder"!==e?v(e):i())}})),o.createElement("div",{className:"nab-regular-upgrade-form__button-container"},o.createElement(l.Button,{variant:"primary",className:"nab-regular-upgrade-form__button",disabled:!g,onClick:function(){r(),m(g,0)}},(0,s._x)("Upgrade Subscription","command","nelio-ab-testing")))):null},mt=function(){return(0,p.useSelect)((function(e){return!e(Re.STORE_NAME).hasFinishedResolution("getProducts")}))},pt=function(){return(0,p.useSelect)((function(e){var t,n=e(Re.STORE_NAME).getProducts,r=e(b),a=r.getSubscriptionProduct,i=r.getSubscriptionAddons,o=a(),c=n(),l=c.filter((function(e){return e.upgradeableFrom.includes(o)})),s=l.filter((function(e){return!e.id.includes("enterprise")})),u=l.find((function(e){return e.id.includes("enterprise-monthly")}))||l.find((function(e){return e.id.includes("enterprise-yearly")})),d=i(),m=c.filter((function(e){return e.isAddon})),p=function(e){var t;return(null!==(t=null==e?void 0:e.allowedAddons)&&void 0!==t?t:[]).filter((function(e){return!!d.find((function(t){return _t(e,t)}))})).map((function(e){return m.find((function(t){return t.id===e}))})).filter((function(e){return!!e}))};return ut(ut([],s.map((function(e){return st(st({},e),{enabledAddons:p(e)})})),!0),[st(st({price:{USD:0,EUR:0},description:{en:"",es:""},enabledAddons:p(u)},u),{id:"nab-enterprise-placeholder",displayName:(0,f.mapValues)(null!==(t=null==u?void 0:u.displayName)&&void 0!==t?t:{en:"",es:""},(function(e){return(0,f.trim)(e.replace(/\([^)]*\)/,""))}))})],!1)}))},ft=function(){return(0,p.useSelect)((function(e){return e(b).getCurrency()||"USD"}))},bt=function(){try{return new Intl.NumberFormat((0,Ue.getLocale)().replace("_","-"))}catch(e){return new Intl.NumberFormat("en-US")}}(),gt=function(e,t,n){var r="EUR"===n?"".concat(bt.format(Math.ceil(t)),"€"):"USD".concat(bt.format(Math.ceil(t)));return"nab-enterprise-placeholder"===e?(0,s.sprintf)(/* translators: price */ /* translators: price */
(0,s._x)("starting from %s","text (money)","nelio-ab-testing"),r):r},vt=function(e){return(0,Ue.getLocale)().startsWith("es")?e.es.replace("de Nelio A/B Testing",""):e.en.replace("Nelio A/B Testing","")},_t=function(e,t){var n=e.substring(0,e.indexOf("addon-")),r=t.substring(0,t.indexOf("addon-"));return!!n&&!!r&&n===r},ht=function(){return ht=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ht.apply(this,arguments)},Et=function(e){var t=(0,p.useSelect)((function(e){return e(b).getPlan()})),n=(0,o.useState)(!1),r=n[0],a=n[1];return"enterprise"===t||r?o.createElement(et,ht({back:"enterprise"!==t&&function(){return a(!1)}},e)):o.createElement(dt,ht({showEnterprise:function(){return a(!0)}},e))},yt=function(e){var t=e.siteId,n=$t();return Bt()?o.createElement(Be,{siteId:t}):o.createElement("div",{className:"nab-account-container__box nab-plan"},o.createElement("div",{className:"nab-plan__content"},o.createElement(xt,null),o.createElement(St,null),o.createElement(u.QuotaMeter,{disabled:n.isLoading,subscriptionQuota:n.data})),o.createElement(wt,null))},xt=function(){var e=Ft().period,t=jt(),n=Lt(),r=Rt(),a="month"===e?(0,s._x)("Monthly","text","nelio-ab-testing"):(0,s._x)("Yearly","text","nelio-ab-testing");return o.createElement("h3",{className:"nab-plan__title"},t,o.createElement("span",{className:"nab-plan__period"},r?(0,s._x)("Free","text","nelio-ab-testing"):a),"canceled"===n&&o.createElement("span",{className:"nab-plan__state"},(0,s._x)("Canceled","text (account state)","nelio-ab-testing")))},St=function(){var e=Rt(),t=Ut(),n=Lt(),r=Mt(),a=Qt(),i=Vt(),c=qt();return e?o.createElement("div",{className:"nab-plan__renewal"},(0,s._x)("You are using the free version of Nelio A/B Testing.","text","nelio-ab-testing")):t?o.createElement("div",{className:"nab-plan__renewal"},Me({mixedString:(0,s.sprintf)(/* translators: 1 -> price and currency; 2 -> date */ /* translators: 1 -> price and currency; 2 -> date */
(0,s._x)("You’re currently using a premium version of Nelio A/B Testing for free. This invitation will end on %s and the plugin will be downgraded to a free plan. Please consider subscribing before that.","user","nelio-ab-testing"),"{{date}}".concat((0,Ue.formatI18nDate)(i),"{{/date}}")),components:{date:o.createElement("span",{className:"nab-plan__renewal-date"})}})):"canceled"===n?o.createElement("div",{className:"nab-plan__renewal"},Me({mixedString:(0,s.sprintf)(/* translators: date */ /* translators: date */
(0,s._x)("Your subscription will end on %s.","text","nelio-ab-testing"),"{{date}}".concat((0,Ue.formatI18nDate)(a),"{{/date}}")),components:{date:o.createElement("span",{className:"nab-plan__renewal-date"})}})):r?o.createElement("div",{className:"nab-plan__renewal"},Me({mixedString:(0,s._x)("{{link}}Contact us{{/link}} to get additional features to manage your account.","text","nelio-ab-testing"),components:{link:o.createElement("a",{href:"mailto:support@neliosoftware.com"})}})):o.createElement("div",{className:"nab-plan__renewal"},Me({mixedString:(0,s.sprintf)(/* translators: 1 -> price and currency; 2 -> date */ /* translators: 1 -> price and currency; 2 -> date */
(0,s._x)("Next charge will be %1$s on %2$s.","text","nelio-ab-testing"),"{{money}}".concat(c,"{{/money}}"),"{{date}}".concat((0,Ue.formatI18nDate)(i),"{{/date}}")),components:{date:o.createElement("span",{className:"nab-plan__renewal-date"}),money:o.createElement("span",{className:"nab-plan__renewal-amount"})}}))},wt=function(){var e=Rt(),t=Ut(),n=Lt();return Mt()?o.createElement("div",{className:"nab-plan__actions"},o.createElement(kt,null),o.createElement(Ot,null)):e||t?o.createElement("div",{className:"nab-plan__actions"},o.createElement(Nt,null),o.createElement(Ct,null)):"canceled"===n?o.createElement("div",{className:"nab-plan__actions"},o.createElement(Tt,null)):o.createElement("div",{className:"nab-plan__actions nab-plan__actions--separated"},o.createElement(At,null),o.createElement("div",{className:"nab-plan__actions-group"},o.createElement(Pt,null),o.createElement(Dt,null),o.createElement(It,null)))},Nt=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1];return o.createElement("span",{className:"nab-plan__action-container"},o.createElement(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!0)}},(0,s._x)("Use License","command","nelio-ab-testing")),o.createElement(Ke,{position:"bottom center",onFocusOutside:function(){return n(!1)},onClick:function(){return n(!1)},isOpen:t}))},Ct=function(){var e=Wt();return o.createElement(l.ExternalLink,{className:"nab-plan__action components-button is-primary",href:(0,se.getSubscribeLink)(e)},(0,se.getSubscribeLabel)(e))},kt=function(){return"enterprise"===Ft().plan?null:o.createElement(l.ExternalLink,{className:"nab-plan__action components-button is-secondary",href:"mailto:support@neliosoftware.com?subject=Buy%20Quota"},(0,s._x)("Buy More Quota","command","nelio-ab-testing"))},Ot=function(){return o.createElement(l.ExternalLink,{className:"nab-plan__action components-button is-primary",href:"mailto:support@neliosoftware.com?subject=Upgrade%20Subscription"},(0,s._x)("Upgrade Subscription","command","nelio-ab-testing"))},At=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1],r=(0,p.useDispatch)(b).cancelSubscription,a=Vt();return o.createElement(o.Fragment,null,o.createElement(l.Button,{isDestructive:!0,className:"nab-plan__action",onClick:function(){return n(!0)}},(0,s._x)("Cancel Subscription","command","nelio-ab-testing")),o.createElement(u.ConfirmationDialog,{title:(0,s._x)("Cancel Subscription?","text","nelio-ab-testing"),text:(0,s.sprintf)(/* translators: a date */ /* translators: a date */
(0,s._x)("Canceling your subscription will cause it not to renew. If you cancel your subscrition, it will continue until %s. Then, the subscription will expire and will not be invoiced again. Do you want to cancel your subscription?","user","nelio-ab-testing"),(0,Ue.formatI18nDate)(a)),isDestructive:!0,confirmLabel:(0,s._x)("Cancel Subscription","command","nelio-ab-testing"),cancelLabel:(0,s._x)("Back","command","nelio-ab-testing"),onCancel:function(){return n(!1)},onConfirm:function(){n(!1),r()},isOpen:t}))},Pt=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1];return"enterprise"===Ft().plan?null:o.createElement("div",null,o.createElement(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!t)}},(0,s._x)("Buy More Quota","command","nelio-ab-testing")),o.createElement(u.QuotaPurchasePopover,{position:"bottom center",onClick:function(){return n(!1)},onFocusOutside:function(){return n(!1)},isOpen:t}))},Dt=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1];return o.createElement("div",null,o.createElement(l.Button,{variant:"secondary",className:"nab-plan__action",onClick:function(){return n(!t)}},(0,s._x)("Addons","text","nelio-ab-testing")),o.createElement(Ve,{position:"bottom center",onFocusOutside:function(){return n(!1)},isOpen:t}))},It=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1];return o.createElement("div",null,o.createElement(l.Button,{variant:"primary",className:"nab-plan__action",onClick:function(){return n(!t)}},(0,s._x)("Upgrade Subscription","command","nelio-ab-testing")),o.createElement(Et,{position:"bottom center",onClick:function(){return n(!1)},onFocusOutside:function(){return n(!1)},isOpen:t}))},Tt=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1],r=(0,p.useDispatch)(b).uncancelSubscription,a=Vt();return o.createElement(o.Fragment,null,o.createElement(l.Button,{variant:"primary",className:"nab-plan__action",onClick:function(){return n(!0)}},(0,s._x)("Reactivate Subscription","command","nelio-ab-testing")),o.createElement(u.ConfirmationDialog,{title:(0,s._x)("Reactivate Subscription?","text","nelio-ab-testing"),text:(0,s.sprintf)(/* translators: a date */ /* translators: a date */
(0,s._x)("Reactivating your subscription will cause it to renew on %s. Do you want to reactivate your subscription?","user","nelio-ab-testing"),(0,Ue.formatI18nDate)(a)),confirmLabel:(0,s._x)("Reactivate Subscription","command","nelio-ab-testing"),cancelLabel:(0,s._x)("Back","command","nelio-ab-testing"),onCancel:function(){return n(!1)},onConfirm:function(){n(!1),r()},isOpen:t}))},Ft=function(){return(0,p.useSelect)((function(e){return{period:e(b).getPeriod(),plan:e(b).getPlan()}}))},Lt=function(){return(0,p.useSelect)((function(e){return e(b).getState()}))},Mt=function(){return(0,p.useSelect)((function(e){return e(b).isSubscriptionDeprecated()}))},Rt=function(){return(0,p.useSelect)((function(e){return"free"===e(b).getMode()}))},Ut=function(){return(0,p.useSelect)((function(e){return"invitation"===e(b).getMode()}))},Bt=function(){return(0,p.useSelect)((function(e){return e(b).isAgency()&&!e(b).isAgencyFullViewEnabled()}))},jt=function(){return(0,p.useSelect)((function(e){return e(b).getProductDisplay()}))},Qt=function(){return(0,p.useSelect)((function(e){return e(b).getDeactivationDate()||e(Re.STORE_NAME).getToday()}))},Vt=function(){return(0,p.useSelect)((function(e){return e(b).getNextChargeDate()||e(Re.STORE_NAME).getToday()}))},qt=function(){return(0,p.useSelect)((function(e){return e(b).getNextChargeTotal()}))},Wt=function(){return(0,p.useSelect)((function(e){return e(Re.STORE_NAME).getToday()}))},$t=function(){return(0,p.useSelect)((function(e){return{data:e(b).getSubscriptionQuota(),isLoading:!e(b).hasFinishedResolution("getSubscriptionQuota")}}))},Yt=function(){return Yt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Yt.apply(this,arguments)},Gt=function(e){var t=e.label,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["label"]),r=(0,o.useState)(!1),a=r[0],i=r[1],c=(0,p.useSelect)((function(e){return e(Re.STORE_NAME).getPluginSetting("siteId")})),d=(0,p.useSelect)((function(e){return e(b).isLocked()})),m=(0,p.useDispatch)(b).unlinkSite;return o.createElement(o.Fragment,null,o.createElement(l.Button,Yt({onClick:function(){return i(!0)},disabled:d},n),t),o.createElement(u.ConfirmationDialog,{title:(0,s._x)("Downgrade to Free Version?","text","nelio-ab-testing"),text:(0,s._x)("This action will remove the license from this site so that you can use it somewhere else. Nelio A/B Testing will remain active on this site, but you will be using the free version instead. Do you want to continue?","user","nelio-ab-testing"),confirmLabel:(0,s._x)("Downgrade","command (remove license)","nelio-ab-testing"),cancelLabel:(0,s._x)("Back","command","nelio-ab-testing"),isDestructive:!0,onCancel:function(){return i(!1)},onConfirm:function(){m(c),i(!1)},isOpen:a}))},Kt=function(){var e=Ht(),t=zt(),n=Jt(),r=Xt(),a=Zt(),i=en(),c=(0,o.useState)(!1),u=c[0],d=c[1];return e?o.createElement("div",{className:"nab-account-container__box nab-info"},o.createElement("h3",{className:"nab-info__title"},(0,s._x)("Account Information","title (account)","nelio-ab-testing")),o.createElement("div",{className:"nab-info__container"},o.createElement("div",{className:"nab-info__profile"},o.createElement("div",{className:"nab-info__picture nab-first-letter-a"},o.createElement("div",{className:"nab-info__actual-picture",style:{backgroundImage:"url(".concat(i,")")}}))),o.createElement("div",{className:"nab-info__details"},o.createElement("p",{className:"nab-info__name"},t),o.createElement("p",{className:"nab-info__email"},o.createElement(l.Dashicon,{icon:"email",className:"nab-info__icon"}),n),o.createElement("p",{className:"nab-info__creation-date"},o.createElement(l.Dashicon,{icon:"calendar",className:"nab-info__icon"}),Me({mixedString:(0,s.sprintf)(/* translators: date */ /* translators: date */
(0,s._x)("Member since %s.","text","nelio-ab-testing"),"{{date}}".concat((0,Ue.formatI18nDate)(r),"{{/date}}")),components:{date:o.createElement("strong",null)}})),o.createElement("div",{className:"nab-info__license"},o.createElement(l.Dashicon,{icon:"admin-network",className:"nab-info__icon"}),o.createElement("code",{title:(0,s._x)("License Key","text","nelio-ab-testing")},a),o.createElement("div",{className:"nab-info__change-license"},o.createElement(l.Button,{variant:"link",onClick:function(){return d(!0)}},(0,s._x)("Change","command","nelio-ab-testing")),o.createElement(Ke,{isOpen:u,position:"bottom center",onClick:function(){return d(!1)},onFocusOutside:function(){return d(!1)}})),o.createElement("div",{className:"nab-info__remove-license"},o.createElement(Gt,{variant:"link",isDestructive:!0,label:(0,s._x)("Remove","command","nelio-ab-testing")})))))):null},Ht=function(){return(0,p.useSelect)((function(e){var t=e(b),n=t.getMode,r=t.isAgency,a=t.isAgencyFullViewEnabled,i="regular"===n(),o=r()&&!a();return i&&!o}))},zt=function(){return(0,p.useSelect)((function(e){return e(b).getFullname()}))},Jt=function(){return(0,p.useSelect)((function(e){return e(b).getEmail()}))},Xt=function(){return(0,p.useSelect)((function(e){return e(b).getStartDate()||e(Re.STORE_NAME).getToday()}))},Zt=function(){return(0,p.useSelect)((function(e){return e(b).getLicense()}))},en=function(){return(0,p.useSelect)((function(e){return e(b).getPhoto()}))},tn=n(6942),nn=n.n(tn);const rn=window.nab.i18n;var an=function(e){var t=e.displayQuotaLimit,n=e.actualUrl,r=e.id,a=e.isCurrentSite,i=e.usedMonthlyQuota,c=e.maxMonthlyQuota,l=e.url;return o.createElement("li",{className:"nab-site"},o.createElement("span",{className:"nab-site__details"},a?o.createElement("span",{className:"nab-site__url"},o.createElement("span",{className:"nab-site__current-site"},n,!!n&&l!==n&&o.createElement(u.HelpIcon,{className:"nab-site__current-site-help",type:"info",text:(0,s.sprintf)(/* translators: site URL */ /* translators: site URL */
(0,s._x)("Activation URL is “%s”","text","nelio-ab-testing"),l)})),o.createElement("span",{className:"nab-site__label"},(0,s._x)("This site","text","nelio-ab-testing"))):o.createElement("span",{className:"nab-site__url"},o.createElement("a",{href:l,className:nn()("nab-site__link",{"nab-site__link--current":a}),target:"_blank",rel:"noopener noreferrer"},l)),!!t&&o.createElement("small",null,o.createElement("strong",null,(0,s._x)("Quota Usage","text","nelio-ab-testing"),": "),(0,rn.numberFormat)(i)," / ",sn(c))),o.createElement(on,{siteId:r}),o.createElement(cn,{siteId:r}))},on=function(e){var t=e.siteId,n=(0,o.useState)(!1),r=n[0],a=n[1],i=(0,p.useSelect)((function(e){return e(Re.STORE_NAME).canLimitSiteQuota()})),c=(0,p.useDispatch)(b).limitSiteQuota,u=(0,p.useSelect)((function(e){var n,r;return null!==(r=null===(n=e(b).getSite(t))||void 0===n?void 0:n.maxMonthlyQuota)&&void 0!==r?r:-1}));return i?o.createElement(o.Fragment,null,o.createElement(l.Button,{variant:"tertiary",className:"nab-site__limit-quota-button",onClick:function(){return a(!0)}},(0,s._x)("Limit Quota","command","nelio-ab-testing")),r&&o.createElement(ln,{initialValue:"".concat(u),onClose:function(){return a(!1)},onSave:function(e){return c(t,e)}})):null},cn=function(e){var t=e.siteId,n=(0,o.useState)(!1),r=n[0],a=n[1],i=(0,p.useDispatch)(b).unlinkSite;return o.createElement(o.Fragment,null,o.createElement(l.Button,{isDestructive:!0,variant:"tertiary",className:"nab-site__unlink-button",onClick:function(){return a(!0)}},(0,s._x)("Unlink Site","command","nelio-ab-testing")),o.createElement(u.ConfirmationDialog,{title:(0,s._x)("Unlink Site?","text","nelio-ab-testing"),text:(0,s._x)("This will remove the subscription license from the site.","text","nelio-ab-testing"),confirmLabel:(0,s._x)("Unlink","command","nelio-ab-testing"),isOpen:r,onCancel:function(){return a(!1)},onConfirm:function(){a(!1),i(t)}}))},ln=function(e){var t=e.initialValue,n=e.onClose,r=e.onSave,a=(0,o.useState)(!1),i=a[0],c=a[1],u=(0,o.useState)(t),d=u[0],m=u[1],p=d!==t;return o.createElement(l.Modal,{className:"site-quota-dialog",title:(0,s._x)("Site Quota","text","nelio-ab-testing"),onRequestClose:f.noop,isDismissible:!1},o.createElement(l.CheckboxControl,{checked:"-1"!==d,onChange:function(e){return m(e?"1000":"-1")},label:(0,s._x)("Limit quota usage in this site","command","nelio-ab-testing")}),"-1"!==d&&o.createElement(l.TextControl,{type:"number",min:"0",value:d,onChange:m}),o.createElement("div",{className:"site-quota-dialog__actions"},o.createElement(l.Button,{variant:"secondary",onClick:n},p?(0,s._x)("Discard Changes","command","nelio-ab-testing"):(0,s._x)("Close","command","nelio-ab-testing")),o.createElement(l.Button,{variant:"primary",onClick:function(){var e=Number.parseInt(d),t=-1===e?-1:Math.abs(e);c(!0),r(t).then(n).catch((function(){return c(!1)}))},disabled:!p||i},i?(0,s._x)("Saving…","text","nelio-ab-testing"):(0,s._x)("Save","command","nelio-ab-testing"))))},sn=function(e){return-1===e?"∞":(0,rn.numberFormat)(e)},un=function(){return un=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},un.apply(this,arguments)},dn=function(){var e=pn(),t=mn(),n=fn(),r=bn();if(!e)return null;var a=n.length,i=n.length>1||n.some((function(e){return 0<=e.maxMonthlyQuota}));return o.createElement("div",{className:"nab-account-container__box nab-sites"},o.createElement("h3",{className:"nab-sites__title"},(0,s._x)("Sites","text","nelio-ab-testing"),t&&o.createElement(l.Spinner,null),o.createElement("span",{className:"nab-sites__availability"},"".concat(a," / ").concat(r))),o.createElement("ul",{className:"nab-sites__list"},!t&&n.map((function(e){return o.createElement(an,un({key:e.id,displayQuotaLimit:i},e))}))))},mn=function(){return(0,p.useSelect)((function(e){return!e(b).hasFinishedResolution("getSites",[e(b).getSubscriptionId()])}))},pn=function(){return(0,p.useSelect)((function(e){var t=e(b),n=t.getMode,r=t.isAgency,a=t.isAgencyFullViewEnabled,i="regular"===n(),o=r()&&!a();return i&&!o}))},fn=function(){return(0,p.useSelect)((function(e){return e(b).getSites(e(b).getSubscriptionId())||[]}))},bn=function(){return(0,p.useSelect)((function(e){return"enterprise"===e(b).getPlan()?"∞":e(b).getSitesAllowed()}))},gn=function(e){var t=e.invoiceUrl,n=e.reference,r=e.chargeDate,a=e.isRefunded,i=e.subtotalDisplay;return o.createElement("tr",{className:"nab-invoice"},o.createElement("td",{className:"nab-invoice__reference"},o.createElement("a",{href:t,className:"nab-invoice__link",target:"_blank",rel:"noopener noreferrer"},n)),o.createElement("td",{className:"nab-invoice__date"},r),o.createElement("td",{className:"nab-invoice__total"},a&&o.createElement("span",{className:"nab-invoice__label"},(0,s._x)("(Refunded)","text (invoice)","nelio-ab-testing")),o.createElement("span",{className:nn()("nab-invoice__total-value",{"nab-invoice__total-value--refunded":a})},i)))},vn=function(){return vn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},vn.apply(this,arguments)},hn=function(){var e=En(),t=yn(),n=xn(),r=Sn();return e?o.createElement("div",{className:"nab-account-container__box nab-billing"},o.createElement("h3",{className:"nab-billing__title"},(0,s._x)("Billing History","text","nelio-ab-testing"),t&&o.createElement(l.Spinner,null)),!t&&o.createElement(o.Fragment,null,o.createElement(l.ExternalLink,{className:"nab-billing__action",href:r},(0,s._x)("Manage Payments","user","nelio-ab-testing")),o.createElement("table",{className:"nab-billing__container"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",{className:"nab-billing__reference"},(0,s._x)("Invoice Reference","text (account, billing table title)","nelio-ab-testing")),o.createElement("th",{className:"nab-billing__date"},(0,s._x)("Date","text (account, billing table title)","nelio-ab-testing")),o.createElement("th",{className:"nab-billing__total"},(0,s._x)("Total","text (account, billing table title)","nelio-ab-testing")))),o.createElement("tbody",{className:"invoice-list"},n.map((function(e){return o.createElement(gn,vn({key:e.reference},e))})))))):null},En=function(){return(0,p.useSelect)((function(e){var t=e(b),n=t.getMode,r=t.isAgency,a=t.isAgencyFullViewEnabled,i=t.isSubscriptionDeprecated,o="regular"===n(),c=i(),l=r()&&!a();return o&&!c&&!l}))},yn=function(){return(0,p.useSelect)((function(e){return!e(b).hasFinishedResolution("getInvoices",[e(b).getSubscriptionId()])}))},xn=function(){return(0,p.useSelect)((function(e){return e(b).getInvoices(e(b).getSubscriptionId())}))},Sn=function(){return(0,p.useSelect)((function(e){return e(b).getUrlToManagePayments()}))},wn=function(){return(0,p.useSelect)((function(e){return e(b).isLocked()}))?o.createElement(l.Modal,{className:"nab-locked",title:(0,s._x)("Loading…","text","nelio-ab-testing"),shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,isDismissible:!1,onRequestClose:f.noop},o.createElement(l.Spinner,null)):null},Nn=function(e){var t=e.siteId;return o.createElement("div",{className:"nab-account-container"},o.createElement(yt,{siteId:t}),o.createElement(Kt,null),o.createElement(dn,null),o.createElement(hn,null),o.createElement(wn,null))};function Cn(e,t){var n,r,a=t.siteId,i=t.isSubscribed,c=document.getElementById(e);n=o.createElement(l.SlotFillProvider,null,o.createElement(m,{isSubscribed:i,siteId:a}),o.createElement(Ae,null,o.createElement(Nn,{siteId:a})),o.createElement(l.Popover.Slot,null)),(r=c)&&(o.createRoot?(0,o.createRoot)(r).render(n):(0,o.render)(n,r)),(0,u.appendContextualHelp)({screen:"account",questions:d})}})();var a=nab="undefined"==typeof nab?{}:nab;for(var i in r)a[i]=r[i];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();